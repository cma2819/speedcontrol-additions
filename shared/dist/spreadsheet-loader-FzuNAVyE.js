import{r as o,j as t}from"./dialog-import-commentator-Zl_WlTxq.js";import{g as W,a as w,s as G,b as U,c as _,_ as y,d as $,u as P,e as D,f as H,h as z,i as F,j as A,G as p,B as O}from"./Grid-7N0pHnBJ.js";import{l as R,a as N,F as B,I as E,b as T,u as q,T as J}from"./nodecg-jiKkhIrU.js";import{l as k}from"./listItemIconClasses-Mud6W5Wk.js";const K=W("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),V=K;function Q(e){return w("MuiMenuItem",e)}const X=W("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),C=X,Y=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],Z=(e,a)=>{const{ownerState:n}=e;return[a.root,n.dense&&a.dense,n.divider&&a.divider,!n.disableGutters&&a.gutters]},ee=e=>{const{disabled:a,dense:n,divider:r,disableGutters:m,selected:i,classes:c}=e,f=A({root:["root",n&&"dense",a&&"disabled",!m&&"gutters",r&&"divider",i&&"selected"]},Q,c);return y({},c,f)},te=G(U,{shouldForwardProp:e=>_(e)||e==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:Z})(({theme:e,ownerState:a})=>y({},e.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!a.disableGutters&&{paddingLeft:16,paddingRight:16},a.divider&&{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${C.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:$(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${C.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:$(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${C.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:$(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:$(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${C.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${C.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`& + .${V.root}`]:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},[`& + .${V.inset}`]:{marginLeft:52},[`& .${R.root}`]:{marginTop:0,marginBottom:0},[`& .${R.inset}`]:{paddingLeft:36},[`& .${k.root}`]:{minWidth:36}},!a.dense&&{[e.breakpoints.up("sm")]:{minHeight:"auto"}},a.dense&&y({minHeight:32,paddingTop:4,paddingBottom:4},e.typography.body2,{[`& .${k.root} svg`]:{fontSize:"1.25rem"}}))),se=o.forwardRef(function(a,n){const r=P({props:a,name:"MuiMenuItem"}),{autoFocus:m=!1,component:i="li",dense:c=!1,divider:u=!1,disableGutters:f=!1,focusVisibleClassName:g,role:b="menuitem",tabIndex:I,className:x}=r,L=D(r,Y),h=o.useContext(N),j=o.useMemo(()=>({dense:c||h.dense||!1,disableGutters:f}),[h.dense,c,f]),s=o.useRef(null);H(()=>{m&&s.current&&s.current.focus()},[m]);const d=y({},r,{dense:j.dense,divider:u,disableGutters:f}),l=ee(r),v=z(s,n);let S;return r.disabled||(S=I!==void 0?I:-1),t.jsx(N.Provider,{value:j,children:t.jsx(te,y({ref:v,role:b,tabIndex:S,component:i,focusVisibleClassName:F(l.focusVisible,g),className:F(l.root,x)},L,{ownerState:d,classes:l}))})}),M=se,ie=({sheets:e,keys:a,onSubmit:n})=>{const[r,m]=o.useState([]),[i,c]=o.useState(""),[u,f]=o.useState([]),[g,b]=o.useState([]),[I,x]=o.useState(!1);o.useEffect(()=>{document.addEventListener("dialog-dismissed",()=>{c("")})},[]),o.useEffect(()=>{m(e.map(s=>s.name))},[e]),o.useEffect(()=>{var s;i!==""?(f(((s=e.find(d=>d.name===i))==null?void 0:s.columns)??[]),b(a.map(d=>"")),x(!1)):(f([]),b(a.map(d=>"")),x(!1))},[i]);const L=(s,d)=>{b(g.map((l,v)=>v===s?d:l))},h=i!==""&&g.every(s=>s!==""),j=()=>{if(!h)return;const s=a.map((d,l)=>Number(g[l]));n(i,s),x(!0)};return t.jsxs(p,{container:!0,spacing:2,children:[t.jsx(p,{item:!0,xs:4,children:"Select source sheet"}),t.jsx(p,{item:!0,xs:8,children:t.jsxs(B,{fullWidth:!0,variant:"standard",children:[t.jsx(E,{id:"select-sheet-name-label",children:"Sheet name"}),t.jsxs(T,{label:"Sheet name",labelId:"select-sheet-name-label",disabled:r.length===0,onChange:s=>{c(s.target.value)},value:i,children:[t.jsx(M,{value:"",children:"-"}),r.map(s=>t.jsx(M,{value:s,children:s},s))]})]})}),t.jsx(p,{item:!0,xs:12,children:"Select columns"}),g.map((s,d)=>{const l=a[d];return t.jsx(p,{item:!0,xs:4,children:t.jsxs(B,{variant:"standard",fullWidth:!0,children:[t.jsx(E,{id:`select-${l.value}-label`,children:l.label}),t.jsxs(T,{labelId:`select-${l.value}-label`,disabled:u.length===0,onChange:v=>{L(d,Number(v.target.value)??"")},value:s,children:[t.jsx(M,{value:"",children:"-"}),u.map((v,S)=>t.jsx(M,{value:S,children:v},v))]})]})},l.value)}),t.jsx(p,{item:!0,xs:12,children:I?t.jsx(O,{variant:"contained",color:"success",fullWidth:!0,disabled:!0,children:"Finish to import! Feel free to close this dialog."}):t.jsx(O,{variant:"contained",color:"success",fullWidth:!0,onClick:j,disabled:!h,children:"Import"})})]})},le=({onLoad:e})=>{const a=q(),[n,r]=o.useState(""),[m,i]=o.useState(!1);o.useEffect(()=>{document.addEventListener("dialog-dismissed",()=>{r("")})},[]);const c=()=>{i(!0),a.sendMessage("loadSheetsFromSpreadsheet",n).then(u=>{e(n,u)}).catch(()=>{console.error("Failed to load spreadsheet!")}).finally(()=>{i(!1)})};return t.jsxs(p,{container:!0,spacing:2,children:[t.jsx(p,{item:!0,xs:12,children:t.jsx(J,{fullWidth:!0,variant:"standard",label:"Google Spreadsheet URL",onChange:u=>{r(u.currentTarget.value)},value:n})}),t.jsx(p,{item:!0,xs:12,children:t.jsx(O,{fullWidth:!0,variant:"contained",disabled:m,onClick:c,children:"Load Spreadsheet"})})]})};export{ie as C,le as S};
