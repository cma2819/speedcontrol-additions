import{j as e,r as o}from"./dialog-import-commentator-Zl_WlTxq.js";import{r as p}from"./Grid-7N0pHnBJ.js";import{S,C as b}from"./spreadsheet-loader-NULJPBd-.js";import{u as x,D as j,C as v,S as f}from"./nodecg-jiKkhIrU.js";import"./listItemIconClasses-Mud6W5Wk.js";const g=[{label:"Run ID",value:"runId"},{label:"解説名",value:"name"},{label:"Twitch",value:"twitch"},{label:"ニコニココミュニティ",value:"nico"},{label:"YouTube",value:"youtube"},{label:"Twitter",value:"twitter"}],C=()=>{const n=x(),[l,a]=o.useState(""),[d,r]=o.useState([]);return o.useEffect(()=>{document.addEventListener("dialog-dismissed",()=>{a(""),r([])})},[]),e.jsx(j,{children:e.jsx(v,{children:e.jsxs(f,{spacing:2,children:[e.jsx(S,{onLoad:(t,s)=>{a(t),r(s)}}),e.jsx(b,{sheets:d,keys:g,onSubmit:(t,[s,i,m,c,u,h])=>{n.sendMessage("importCommentatorFromSpreadsheet",{url:l,sheetName:t,indexes:{runId:s,name:i,twitch:m,nico:c,youtube:u,twitter:h}}).then(()=>{console.info("Success to import commentators!")}).catch(()=>{console.error("Failed to import commentators.")})}})]})})})};p(e.jsx(C,{}));
